<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BYB Eye Tracking Demo</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/experiments.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet" >
    
</head>
<body>
  <div id="expSection">
    <div id="faceContainer" class="position-absolute w-100 h-100" style="display:none"></div>
    <button id="calibrationButton" style="display:none"></button>
  </div>

  <div class="container mt-5 align-items-center">
    <div class="row justify-content-center d-flex align-items-center custom-height">
      <!-- The Instruction Box -->
      <div id="initialInstructionSection" class="p-4 col-md-10">
          <h1 id="instructionsText" class="text-center">Instructions</h1>

          <p  id="instructionsP1" class="text-center">In this experiment, we will use your webcam to estimate your eye position as you look at pictures.</p>
            
          <p  id="instructionsP2" class="text-center">You will need to keep your head still. It can be helpful to stabilize your head on a stack of books to increase accuracy.</p>
          
          <p  id="instructionsP3" class="text-center">Before we begin, we need to do some calibration.  Find the small green box and click on it 3 times.  This will happen several times.</p>
          
          <div class="d-flex justify-content-center mt-2">
              <button id="closeButton" class="btn btn-primary">Start Experiment</button>
          </div>
      </div>
    </div>
  
    <div class="row justify-content-center d-flex align-items-center custom-height">
      <div id="loadingInstructionsSection" class="p-4 col-md-10">
        <h1 id="loadingImagesTitle" class="text-center">Loading Images</h1>
        <p id="loadingImages1" class="text-center">10 images will be shown for 3 seconds each.  Just enjoy the images and keep still. Easy!</p>
      </div>
    </div>

    <div class="row justify-content-center">
      <div id="finalInstructionsSection" class="p-4 col-md-10">
        <h1 id="EndTitle" class="text-center">All done</h1>
        <p  id="End1" class="text-center">What did you notice?  Where did you tend to look?</p>
        <p  id="End2" class="text-center">We will be processing your results (anonymous eye positions) to determine where people look on average.</p>
        <div class="text-center">
          <a href="/">
              <button id="End3" class="btn btn-primary">Back to Experiments</button>
          </a>
        </div>
      </div>
    </div>
  
  </div>




  <script src="js/webgazer.js"></script>

  <script src="../js/baseExperiment.js"></script>
  <script src="../js/utils.js"></script>
  <script src="js/facegazerExperiment.js"></script>


  <script>       
    document.addEventListener('DOMContentLoaded', function() {
          const button = document.getElementById('closeButton');
          button.addEventListener('click', handleStartGame);
    });

    function handleStartGame(event) {
              runexperiment();
    }
  

    // For debugging the main experiment
    //window.onload = async function() {
    //    const experiment = new EyeTrackingExperiment;
    //    await experiment.generateTrials();

    //    document.getElementById('faceContainer').style.display = 'block';
    //    document.getElementById('initialInstructionSection').style.display = 'none';
    //    await experiment.runTrials();
          
    //};

    async function runexperiment(){

          const experiment = new EyeTrackingExperiment;

          experiment.UUID = generateUUID(); // Replace with Common UUID
          await experiment.generateTrials();

          await experiment.start();
          experiment.end();

    }
   </script>
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
